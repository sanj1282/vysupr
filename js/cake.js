const MAX_LAYERS=10,MIN_WIDTH=125,MAX_WIDTH=275,START_WIDTH=200,LAYER_PERCENTAGE=90,FLAVORS=["strawberry","vanilla","coffee","chocolate","mint","lemon","orange"],CANDLE_COLORS=["candle-pink","candle-blue","candle-green","candle-purple"],SPACE_PER_CANDLE=18,FROSTING_MARGIN=3,BASE_MARGIN=12;class CakeLayer extends React.Component{constructor(e){super(e),this.state={flavorIndex:0},this.changeFlavor=this.changeFlavor.bind(this)}changeFlavor(e){this.props.canBuild&&this.setState((e,t)=>({flavorIndex:e.flavorIndex<FLAVORS.length-1?e.flavorIndex+1:0}))}render(){const e={width:this.props.width+"px",marginLeft:(MAX_WIDTH-this.props.width)/2};let t=Math.floor((this.props.width+2*FROSTING_MARGIN)/10);return t%2==0&&t++,React.createElement("button",{className:"cake-layer "+FLAVORS[this.state.flavorIndex],onClick:this.changeFlavor,style:e},React.createElement(EdgeFrosting,{width:this.props.width,margin:FROSTING_MARGIN,count:t,flavor:FLAVORS[this.state.flavorIndex]}),this.props.frostingOnBottom?React.createElement(EdgeFrosting,{width:this.props.width,margin:BASE_MARGIN,count:t,isBottom:!0,flavor:FLAVORS[this.state.flavorIndex]}):"")}}function EdgeFrosting(e){var t=[];for(let a=0;a<e.count;a++){let s=(a%2==0?"frosting-part":"frosting-part-small")+" "+e.flavor;t.push(React.createElement("div",{key:a,className:s}))}const a={width:e.width+2*e.margin+"px",marginLeft:-e.margin};let s="frosting-row";return e.isBottom&&(s+=" bottom-frosting"),React.createElement("div",{className:s,style:a},t)}class Cake extends React.Component{constructor(e){super(e),this.state={layers:2,candles:3,width:START_WIDTH,candlesBlownOut:!1,canBuild:!0,eating:!1,eatTimer:-1},this.addLayer=this.addLayer.bind(this),this.removeLayer=this.removeLayer.bind(this),this.addCandle=this.addCandle.bind(this),this.removeCandle=this.removeCandle.bind(this),this.addWidth=this.addWidth.bind(this),this.removeWidth=this.removeWidth.bind(this),this.beginEat=this.beginEat.bind(this),this.eat=this.eat.bind(this),this.removeAllCandles=this.removeAllCandles.bind(this)}componentDidMount(){const e=document.scrollingElement||document.body;window.scrollTo(0,e.scrollHeight)}componentWillUnmount(){-1!=this.state.eatTimer&&window.clearInterval(this.state.eatTimer)}getMaxCandles(e,t){return e*Math.pow(LAYER_PERCENTAGE/100,t-1)/SPACE_PER_CANDLE}addLayer(){this.state.canBuild&&this.setState((e,t)=>({layers:Math.min(e.layers+1,MAX_LAYERS),candles:Math.min(e.candles,this.getMaxCandles(e.width,Math.min(e.layers+1,MAX_LAYERS)))}))}removeLayer(){this.state.canBuild&&this.state.layers>0&&this.setState((e,t)=>({layers:Math.max(e.layers-1,1)}))}addCandle(){this.state.canBuild&&this.state.layers>0&&this.setState((e,t)=>({candles:Math.min(e.candles+1,this.getMaxCandles(e.width,e.layers))}))}removeCandle(){this.state.canBuild&&this.state.layers>0&&this.setState((e,t)=>({candles:Math.max(e.candles-1,0)}))}addWidth(){this.state.canBuild&&this.state.layers>0&&this.setState((e,t)=>({width:Math.min(e.width+25,MAX_WIDTH)}))}removeWidth(){this.state.canBuild&&this.state.layers>0&&this.setState((e,t)=>({width:Math.max(e.width-25,MIN_WIDTH),candles:Math.min(e.candles,this.getMaxCandles(Math.max(e.width-25,MIN_WIDTH),e.layers))}))}beginEat(){if(this.state.canBuild&&this.state.layers>0){const e=window.setInterval(this.removeAllCandles,1e3);this.setState({candlesBlownOut:!0,canBuild:!1,eating:!0,eatTimer:e})}}removeAllCandles(){window.clearInterval(this.state.eatTimer);const e=window.setInterval(this.eat,100);this.setState({eatTimer:e})}eat(){this.state.candles>0?this.setState({candles:0}):this.setState((e,t)=>{const a=Math.max(e.layers-1,0);let s=!1;return 0==a&&(s=!0,window.clearInterval(e.eatTimer)),{layers:a,canBuild:s,eating:!s,candlesBlownOut:!s}})}render(){let e=[];for(let t=0;t<this.state.layers;t++){let a=this.state.width*Math.pow(LAYER_PERCENTAGE/100,t),s=0==t;e.push(React.createElement(CakeLayer,{key:t,width:a,frostingOnBottom:s,canBuild:this.state.canBuild}))}let t=this.state.width*Math.pow(LAYER_PERCENTAGE/100,this.state.layers-1);return React.createElement(React.Fragment,null,this.state.candles>0?React.createElement(CandleRow,{width:t,count:this.state.candles,blownOut:this.state.candlesBlownOut,canBuild:this.state.canBuild}):"",React.createElement("div",{className:"cake"},e),React.createElement(CakeControls,{addLayer:this.addLayer,removeWidth:this.removeWidth,addWidth:this.addWidth,removeLayer:this.removeLayer,addCandle:this.addCandle,removeCandle:this.removeCandle,eatAction:this.beginEat,canBuild:this.state.canBuild}))}}function CakeControls(e){const t=e.canBuild?"":" no-build";return React.createElement("div",{className:"cake-controls"},React.createElement("div",{className:"direction-controls"},React.createElement("button",{className:"btn-up"+t,onClick:e.addLayer},React.createElement("i",{className:"fas fa-angle-up"})),React.createElement("button",{className:"btn-narrow"+t,onClick:e.removeWidth},React.createElement("i",{className:"fas fa-angle-right"}),React.createElement("i",{className:"fas fa-angle-left"})),React.createElement("button",{className:"btn-wide"+t,onClick:e.addWidth},React.createElement("i",{className:"fas fa-angle-left"}),React.createElement("i",{className:"fas fa-angle-right"})),React.createElement("button",{className:"btn-down"+t,onClick:e.removeLayer},React.createElement("i",{className:"fas fa-angle-down"}))),React.createElement("button",{className:"btn-add"+t,onClick:e.addCandle},React.createElement("i",{className:"fas fa-plus"})),React.createElement("button",{className:"btn-remove"+t,onClick:e.removeCandle},React.createElement("i",{className:"fas fa-minus"})),React.createElement("div",{className:"help-candle"+t},React.createElement("i",{className:"fas fa-burn"}),React.createElement("div",{className:"help-candle-base"})),React.createElement("button",{className:"btn-eat"+t,onClick:e.eatAction},"EAT"))}function Plate(e){return React.createElement("div",{className:"plate"},React.createElement("div",{className:"plate-row"},React.createElement("div",{className:"plate-left"}),React.createElement("div",{className:"plate-top"}),React.createElement("div",{className:"plate-right"})),React.createElement("div",{className:"plate-row"},React.createElement("div",{className:"plate-base"})))}function CandleRow(e){const t={width:e.width+"px"};let a=[];for(let t=0;t<e.count;t++)a.push(React.createElement(Candle,{key:t,blownOut:e.blownOut,canBuild:e.canBuild}));return React.createElement("div",{className:"candle-row",style:t},a)}class Candle extends React.Component{constructor(e){super(e),this.state={colorIndex:0},this.changeColor=this.changeColor.bind(this)}changeColor(){this.props.canBuild&&this.setState((e,t)=>({colorIndex:e.colorIndex<CANDLE_COLORS.length-1?e.colorIndex+1:0}))}render(){let e=[];for(let t=0;t<4;t++){let a=t%2==0?"candle-section":"candle-section-2";e.push(React.createElement("div",{className:a+" "+CANDLE_COLORS[this.state.colorIndex],key:t}))}return React.createElement("div",{className:"candle"},React.createElement("button",{className:"candle-stick "+CANDLE_COLORS[this.state.colorIndex],onClick:this.changeColor},e),React.createElement("div",{className:"wick"}),this.props.blownOut?"":React.createElement("div",{className:"fire"},React.createElement("i",{className:"fas fa-burn"})))}}ReactDOM.render(React.createElement(React.Fragment,null,React.createElement(Cake,null),React.createElement(Plate,null)),document.getElementById("container"));